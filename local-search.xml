<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ä»é›¶å¼€å§‹å®ç°ä¸€ä¸ªmini reactDnd ğŸ‘‰</title>
    <link href="/2022/04/16/reactDnd/"/>
    <url>/2022/04/16/reactDnd/</url>
    
    <content type="html"><![CDATA[<p><img src="/2022/04/16/reactDnd/redpanda.jpg"></p><p>å…ˆä¸€ä¸ªã€Šé’æ˜¥å˜å½¢è®°ã€‹æµ·æŠ¥é•‡æ¥¼ï¼Œå¼ºçƒˆæ¨èğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ<br>æœ€è¿‘é¡¹ç›®ä¸­ä½¿ç”¨react-dndï¼Œå‡ºç°äº†ä¸€äº›è­¦å‘Šbugï¼Œä¸ºäº†å¼„æ¸…è­¦å‘Šæ¥æºï¼Œå¼€å§‹ç ”ç©¶react-dndæºç ï¼Œå‘ç°ä½œè€…çš„æ€è·¯ç®€ç›´ç¥çº§ï¼Œæƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï½</p><h2 id="react-dndè®¾è®¡æ€è·¯"><a href="#react-dndè®¾è®¡æ€è·¯" class="headerlink" title="react-dndè®¾è®¡æ€è·¯"></a>react-dndè®¾è®¡æ€è·¯</h2><p><img src="/2022/04/16/reactDnd/step1.png"><br><img src="/2022/04/16/reactDnd/step2.png"><br><img src="/2022/04/16/reactDnd/step3.png"><br>å°±æ­¤ æ•´ä¸ªæ‹–æ‹½è¿‡ç¨‹ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ­£å¸¸å·¥ä½œé“¾ï¼Œè¿™æ˜¯ä¸æ˜¯å°±ç»“æŸäº†å‘¢ï¼Ÿï¼Ÿ<br>è¿›è¡Œæ€è€ƒğŸ¤”<br>è™½ç„¶ å‘˜å·¥ AA å¹²æ´»æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œ æ¯•ç«Ÿè¿™æ˜¯åœ¨HTMLä¸­ï¼Œæ‹–æ‹½éƒ½æ˜¯é€šè¿‡DOMèŠ‚ç‚¹å»å·¥ä½œçš„ï¼Œ<br>æ€ä¹ˆèƒ½å°† å‘˜å·¥AA ä¸€ä¸ªclassç±»  å’Œ DOMæ‹–æ‹½åŠŸèƒ½ç»“åˆå‘¢<br><img src="/2022/04/16/reactDnd/step4.png"><br>é€šè¿‡ä»¥ä¸Šï¼Œå°±æ˜¯æ•´ä¸ªreact-dndçš„è®¾è®¡æ€æƒ³äº†ï¼Œæœ‰æ²¡æœ‰å¾ˆå·§å¦™å‘¢</p><h2 id="å¼€å§‹å®ç°"><a href="#å¼€å§‹å®ç°" class="headerlink" title="å¼€å§‹å®ç°"></a>å¼€å§‹å®ç°</h2><h3 id="Step1-å®ç°DndProviderå’Œmanagerå’Œbackendè¿æ¥"><a href="#Step1-å®ç°DndProviderå’Œmanagerå’Œbackendè¿æ¥" class="headerlink" title="Step1 å®ç°DndProviderå’Œmanagerå’Œbackendè¿æ¥"></a>Step1 å®ç°DndProviderå’Œmanagerå’Œbackendè¿æ¥</h3><p>ä¸»è¦è´Ÿè´£<br><img src="/2022/04/16/reactDnd/step5.png"></p><h4 id="1ã€é¦–å…ˆå…ˆä¸‹è½½åˆå§‹åŒ–æ–‡ä»¶"><a href="#1ã€é¦–å…ˆå…ˆä¸‹è½½åˆå§‹åŒ–æ–‡ä»¶" class="headerlink" title="1ã€é¦–å…ˆå…ˆä¸‹è½½åˆå§‹åŒ–æ–‡ä»¶"></a>1ã€é¦–å…ˆå…ˆä¸‹è½½åˆå§‹åŒ–æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/beewolf233/mini-reactdnd/tree/dev_init<br>npm install<br>npm run start<br></code></pre></td></tr></table></figure><h4 id="2ã€åœ¨srcæ–‡ä»¶å¤¹åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹"><a href="#2ã€åœ¨srcæ–‡ä»¶å¤¹åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹" class="headerlink" title="2ã€åœ¨srcæ–‡ä»¶å¤¹åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹"></a>2ã€åœ¨srcæ–‡ä»¶å¤¹åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">dnd-core<br>react-dnd<br>react-dnd-html5-backend<br></code></pre></td></tr></table></figure><p>dnd-core ä¸»è¦è´Ÿè´£ manager æ€»ç»ç†è§’è‰²<br>react-dnd ä¸­ ä¸»è¦è´Ÿè´£ reactDndï¼Œ useDrag, useDrop åŠŸèƒ½å®ç°<br>react-dnd-html5-backend ä¸»è¦è´Ÿè´£DOMåå°</p><h4 id="3ã€react-dndä¸­åˆ›å»ºcoreæ–‡ä»¶"><a href="#3ã€react-dndä¸­åˆ›å»ºcoreæ–‡ä»¶" class="headerlink" title="3ã€react-dndä¸­åˆ›å»ºcoreæ–‡ä»¶"></a>3ã€react-dndä¸­åˆ›å»ºcoreæ–‡ä»¶</h4><p>coreæ–‡ä»¶å¯ä»¥é€šè¿‡reactçš„createContextï¼Œåˆ›å»ºä¸Šä¸‹æ–‡<br><img src="/2022/04/16/reactDnd/example1.png"><br>core/DndContext</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; createContext &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">DndContext</span> = <span class="hljs-title function_">createContext</span>(&#123; <span class="hljs-attr">dragDropManager</span>: <span class="hljs-literal">undefined</span> &#125;);<br></code></pre></td></tr></table></figure><p>core/DndProvider</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">DndContext</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./DndContext&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; createDragDropManager &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../../dnd-core&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">DndProvider</span> = (<span class="hljs-params">&#123; children, backend &#125;</span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> value = &#123; <span class="hljs-attr">dragDropManager</span>: <span class="hljs-title function_">createDragDropManager</span>(backend)&#125;;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">DndContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;value&#125;</span>&gt;</span></span><br><span class="language-xml">      &#123;children&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">DndContext.Provider</span>&gt;</span></span><br>  )<br>&#125;;<br></code></pre></td></tr></table></figure><p>core/index</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./DndContext&#x27;</span><br><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./DndProvider&#x27;</span><br></code></pre></td></tr></table></figure><p>index</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./core&#x27;</span>;<br></code></pre></td></tr></table></figure><h4 id="4ã€dnd-coreåˆ›å»ºmanagerï¼Œé€å‡ºcreateDragDropManager"><a href="#4ã€dnd-coreåˆ›å»ºmanagerï¼Œé€å‡ºcreateDragDropManager" class="headerlink" title="4ã€dnd-coreåˆ›å»ºmanagerï¼Œé€å‡ºcreateDragDropManager"></a>4ã€dnd-coreåˆ›å»ºmanagerï¼Œé€å‡ºcreateDragDropManager</h4><p>createDragDropManager</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;redux&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">DragDropManagerImpl</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./classes/DragDropManagerImpl&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">DragDropMonitorImpl</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./classes/DragDropMonitorImpl&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">HandlerRegistryImpl</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./classes/HandlerRegistryImpl&#x27;</span>;<br><span class="hljs-keyword">import</span> reduce <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./reducers/index&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createDragDropManager</span> = (<span class="hljs-params"></span><br><span class="hljs-params">  backendFactory</span><br><span class="hljs-params"></span>)=&gt; &#123;<br>  <span class="hljs-comment">// åˆ›å»ºstore</span><br>  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reduce);<br>  <span class="hljs-comment">// åˆ›å»ºæ³¨å†Œç±»</span><br>  <span class="hljs-keyword">const</span> registry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerRegistryImpl</span>(store);<br>  <span class="hljs-comment">// æ³¨å†Œç±»æ³¨å…¥åˆ°ç›‘å¬å™¨ä¸­ï¼Œåˆ›å»ºç›‘å¬å™¨ äººäº‹</span><br>  <span class="hljs-keyword">const</span> monitor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DragDropMonitorImpl</span>(store, registry);<br>  <span class="hljs-comment">// åˆ›å»ºmanager æ€»ç»ç†</span><br>  <span class="hljs-keyword">const</span> manager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DragDropManagerImpl</span>(store, monitor);<br>  <span class="hljs-comment">// ä¼ å…¥åå°ï¼Œä¸€æ–¹é¢manageré€šè¿‡backendFactoryæ³¨å…¥åˆ°backend</span><br>  <span class="hljs-keyword">const</span> backend = <span class="hljs-title function_">backendFactory</span>(manager);<br>  <span class="hljs-comment">// å¦ä¸€æ–¹é¢ backendå®ä¾‹ä¹Ÿæ³¨å…¥åˆ°managerä¸­</span><br>  manager.<span class="hljs-title function_">receiveBackend</span>(backend)<br>  <span class="hljs-keyword">return</span> manager;<br>&#125;;<br><br></code></pre></td></tr></table></figure><p>index</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./createDragDropManager&#x27;</span>;<br></code></pre></td></tr></table></figure><h4 id="5ã€react-dnd-html5-backendä¸­åˆ›å»ºbackend"><a href="#5ã€react-dnd-html5-backendä¸­åˆ›å»ºbackend" class="headerlink" title="5ã€react-dnd-html5-backendä¸­åˆ›å»ºbackend"></a>5ã€react-dnd-html5-backendä¸­åˆ›å»ºbackend</h4><p>HTML5BackendImpl</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML5BackendImpl</span> &#123;<br>  manager<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">manager</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">manager</span> = manager<br>  &#125;;<br>&#125;;<br></code></pre></td></tr></table></figure><p>index</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">HTML5BackendImpl</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./HTML5BackendImpl&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HTML5Backend</span>(<span class="hljs-params">manager</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HTML5BackendImpl</span>(manager);<br>&#125;;<br><br></code></pre></td></tr></table></figure><h4 id="6ã€App-js"><a href="#6ã€App-js" class="headerlink" title="6ã€App.js"></a>6ã€App.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">HTML5Backend</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./react-dnd-html5-backend&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">DndProvider</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./react-dnd&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Container</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./SimpleCard&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./App.css&#x27;</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">DndProvider</span> <span class="hljs-attr">backend</span>=<span class="hljs-string">&#123;HTML5Backend&#125;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Container</span> /&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">DndProvider</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  );<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;<br></code></pre></td></tr></table></figure><p><img src="/2022/04/16/reactDnd/step6.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://github.com/beewolf233/mini-reactdnd/commit/1e0f0b454a924db8869ffd2ac4646b79abfe7c93<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸Šcommitè·å–æœ¬æ­¥éª¤ä»£ç â¬†ï¸</p><p>æ¥ä¸‹æ¥çš„Stepè¯·çœ‹ç¬¬äºŒç¯‡æ–‡ç« </p>]]></content>
    
    
    
    <tags>
      
      <tag>mini-react-dnd</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
